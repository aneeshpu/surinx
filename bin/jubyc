$: << File.join(File.dirname(__FILE__), '..', 'lib')
require 'juby'

if ARGV[0] == '-e'
  src = ARGV[1]
  name = "dash_e"
elsif ARGV[0]
  src = File.read(ARGV[0])
  name = ARGV[0]
else
  raise "usage: jubyc -e \"script\" or jubyc <file.jb>"
end

node = JRuby.parse(src)
c = Compiler.new(name)
c.compile(node)
c.write